## exponential decay

The equation
```math
N(t) = N_0 e^{-\lambda t}
```
describes the exponential decay of a population in time.
However, it doesn't tell us anything about the random nature of such a process on the individual level.
We shall have a look at the probabilistic microscopic model.

---

Let us call the decay of an individual as an *event*.
An important assumption is that the random events are *independent* of each other.
Then the decay of an individual is modelled as a **Poisson process** with a fixed rate $\lambda$ (an average number of events per unit time).
It can be shown that the occurrence of the events follows the Poisson distribution,
and that the time intervals between two events are *always* (at any time) given by the exponential probability density:
```math
f(t) = \lambda e^{-\lambda t}
```

A random time $t$ of the next event sampled from the exponential distribution can be found by selecting a random number $u$
from the uniform distribution on \[0,1) and inverting the cumulative distribution function of the exponential probability.
```math
u = \int_0^t f(t')dt' = 1-e^{-\lambda t}
```
```math
t = -\frac{1}{\lambda} \log(1-u)
```

In this Monte Carlo experiment, we study the exponential distribution, namely its two properties:
- **no memory** (or no "age"). As we continue waiting for an event, the probability of the event occurring "soon" remains still the same.
- a minimum of $n$ exponentially distributed random variables with rate $\lambda$ is **also** an exponentially distributed random variable with rate $n\lambda$.

We simulate trajectories of an exponential decay of a population of e.g. radioactive nuclei with rate $\lambda$.
There are two versions of the simulation:
- we simulate the time of decay of every *individual* nucleus in the population, each with rate $\lambda$.
  Then we sort the times in ascending order.
- we simulate the time of decay of the next nucleus with rate $N\lambda$, where $N$ is the current number of the nuclei in the *ensemble*.
  Then we repeat the process with the remaining nuclei.

By a visual inspection of trajectories generated by the two versions, we conclude they yield the same results.
Therefore, the two approaches to the simulation are equivalent.

---

While the exponential decay can be derived directly from the Poisson statistics,
we may also see that it emerges from the fact that decay rate of the ensemble is proportional to the ensemble size
```math
\frac{dN(t)}{dt} = -\lambda N(t)
```

Although the individual nucleus decay events follow the Poisson distribution, the decay events of the ensemble, in general, do not.
The reason for this is again that the decay rate of the population $\lambda N(t)$ is not constant.
One can use the Poisson statistics in the case where the number of decayed nuclei $\Delta N$ during the observation time window is negligible to the size of the ensemble $\Delta N \ll N_0$.
During this window, the rate is approximately constant: $\approx \lambda N_0$.
